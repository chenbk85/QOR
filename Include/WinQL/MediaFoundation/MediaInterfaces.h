//MediaInterfaces.h

// Copyright Querysoft Limited 2015
//
// Permission is hereby granted, free of charge, to any person or organization
// obtaining a copy of the software and accompanying documentation covered by
// this license (the "Software") to use, reproduce, display, distribute,
// execute, and transmit the Software, and to prepare derivative works of the
// Software, and to permit third-parties to whom the Software is furnished to
// do so, all subject to the following:
//
// The copyright notices in the Software and this entire statement, including
// the above license grant, this restriction and the following disclaimer,
// must be included in all copies of the Software, in whole or in part, and
// all derivative works of the Software, unless such copies or derivative
// works are solely in the form of machine-executable object code generated by
// a source language processor.
//
// THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
// IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
// FITNESS FOR A PARTICULAR PURPOSE, TITLE AND NON-INFRINGEMENT. IN NO EVENT
// SHALL THE COPYRIGHT HOLDERS OR ANYONE DISTRIBUTING THE SOFTWARE BE LIABLE
// FOR ANY DAMAGES OR OTHER LIABILITY, WHETHER IN CONTRACT, TORT OR OTHERWISE,
// ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER
// DEALINGS IN THE SOFTWARE.

#ifndef WINQL_MEDIAINTERFACES_H_3
#define WINQL_MEDIAINTERFACES_H_3

#ifdef	__QCMP_OPTIMIZEINCLUDE
#pragma	__QCMP_OPTIMIZEINCLUDE
#endif//__QCMP_OPTIMIZEINCLUDE

#include "WinQL/Definitions/Handles.h"
#include "WinQL/Definitions/Security.h"
#include "WinQL/Definitions/Data.h"
#include "WinQL/Definitions/IO.h"

//Common Object Model Media Foundation interface definitions for the Microsoft Windows Operating System

//--------------------------------------------------------------------------------
namespace nsWin32
{
	//--------------------------------------------------------------------------------
	//MIDL_INTERFACE("2cd2d921-c447-44a7-a13c-4adabfc247e3")
	struct __QOR_INTERFACE(__WINQL_MEDIA) IMFAttributes : public IUnknown
	{
	public:

		static const GUID _IID;

		virtual unsigned long __QCMP_STDCALLCONVENTION GetItem(const GUID& guidKey, PROPVARIANT* pValue) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION GetItemType(const GUID& guidKey, MF_ATTRIBUTE_TYPE* pType) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION CompareItem(const GUID& guidKey, const PROPVARIANT& Value, int* pbResult) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION Compare(IMFAttributes *pTheirs, MF_ATTRIBUTES_MATCH_TYPE MatchType, int* pbResult) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION GetUINT32(const GUID& guidKey, Cmp_unsigned__int32* punValue) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION GetUINT64(const GUID& guidKey, Cmp_unsigned__int64* punValue) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION GetDouble(const GUID& guidKey, double* pfValue) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION GetGUID(const GUID& guidKey, GUID* pguidValue) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION GetStringLength(const GUID& guidKey, Cmp_unsigned__int32 *pcchLength) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION GetString(const GUID& guidKey, wchar_t* pwszValue, Cmp_unsigned__int32 cchBufSize, Cmp_unsigned__int32 *pcchLength) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION GetAllocatedString(const GUID& guidKey, wchar_t** ppwszValue, Cmp_unsigned__int32* pcchLength) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION GetBlobSize(const GUID& guidKey, Cmp_unsigned__int32 *pcbBlobSize) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION GetBlob(const GUID& guidKey, Cmp_unsigned__int8* pBuf, Cmp_unsigned__int32 cbBufSize, Cmp_unsigned__int32* pcbBlobSize) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION GetAllocatedBlob(const GUID& guidKey, Cmp_unsigned__int8** ppBuf, Cmp_unsigned__int32* pcbSize) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION GetUnknown(const GUID& guidKey, const GUID& riid, void** ppv) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION SetItem(const GUID& guidKey, const PROPVARIANT& Value) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION DeleteItem(const GUID& guidKey) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION DeleteAllItems(void) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION SetUINT32(const GUID& guidKey, Cmp_unsigned__int32 unValue) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION SetUINT64(const GUID& guidKey, Cmp_unsigned__int64 unValue) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION SetDouble(const GUID& guidKey, double fValue) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION SetGUID(const GUID& guidKey, const GUID& guidValue) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION SetString(const GUID& guidKey, const wchar_t* wszValue) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION SetBlob(const GUID& guidKey, const Cmp_unsigned__int8* pBuf, Cmp_unsigned__int32 cbBufSize) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION SetUnknown(const GUID& guidKey, IUnknown *pUnknown) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION LockStore(void) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION UnlockStore(void) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION GetCount(Cmp_unsigned__int32* pcItems) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION GetItemByIndex(Cmp_unsigned__int32 unIndex, GUID *pguidKey, PROPVARIANT *pValue) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION CopyAllItems(IMFAttributes* pDest) = 0;

	};

	//--------------------------------------------------------------------------------
	//MIDL_INTERFACE("44ae0fa8-ea31-4109-8d2e-4cae4997c555")
	struct __QOR_INTERFACE(__WINQL_MEDIA) IMFMediaType : public IMFAttributes
	{
	public:

		static const GUID _IID;

		virtual unsigned long __QCMP_STDCALLCONVENTION GetMajorType(GUID* pguidMajorType) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION IsCompressedFormat(int* pfCompressed) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION IsEqual(IMFMediaType* pIMediaType, unsigned long* pdwFlags) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION GetRepresentation(GUID guidRepresentation, void** ppvRepresentation) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION FreeRepresentation(GUID guidRepresentation, void* pvRepresentation) = 0;

	};

	//--------------------------------------------------------------------------------
	//MIDL_INTERFACE("83CF873A-F6DA-4bc8-823F-BACFD55DC430")
	struct __QOR_INTERFACE(__WINQL_MEDIA) IMFTopologyNode : public IMFAttributes
	{
	public:

		static const GUID _IID;

		virtual unsigned long __QCMP_STDCALLCONVENTION SetObject(IUnknown* pObject) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION GetObject(IUnknown** ppObject) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION GetNodeType(MF_TOPOLOGY_TYPE* pType) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION GetTopoNodeID(Cmp_unsigned__int64* pID) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION SetTopoNodeID(Cmp_unsigned__int64 ullTopoID) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION GetInputCount(unsigned long* pcInputs) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION GetOutputCount(unsigned long* pcOutputs) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION ConnectOutput(unsigned long dwOutputIndex, IMFTopologyNode* pDownstreamNode, unsigned long dwInputIndexOnDownstreamNode) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION DisconnectOutput(unsigned long dwOutputIndex) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION GetInput(unsigned long dwInputIndex, IMFTopologyNode** ppUpstreamNode, unsigned long* pdwOutputIndexOnUpstreamNode) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION GetOutput(unsigned long dwOutputIndex, IMFTopologyNode** ppDownstreamNode, unsigned long* pdwInputIndexOnDownstreamNode) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION SetOutputPrefType(unsigned long dwOutputIndex, IMFMediaType* pType) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION GetOutputPrefType(unsigned long dwOutputIndex, IMFMediaType** ppType) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION SetInputPrefType(unsigned long dwInputIndex, IMFMediaType* pType) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION GetInputPrefType(unsigned long dwInputIndex, IMFMediaType** ppType) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION CloneFrom(IMFTopologyNode* pNode) = 0;

	};

	//--------------------------------------------------------------------------------
	//MIDL_INTERFACE("5BC8A76B-869A-46a3-9B03-FA218A66AEBE")
	struct __QOR_INTERFACE(__WINQL_MEDIA) IMFCollection : public IUnknown
	{
	public:

		static const GUID _IID;

		virtual unsigned long __QCMP_STDCALLCONVENTION GetElementCount(unsigned long* pcElements) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION GetElement(unsigned long dwElementIndex, IUnknown** ppUnkElement) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION AddElement(IUnknown* pUnkElement) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION RemoveElement(unsigned long dwElementIndex, IUnknown** ppUnkElement) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION InsertElementAt(unsigned long dwIndex, IUnknown* pUnknown) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION RemoveAllElements(void) = 0;
	};

	//--------------------------------------------------------------------------------
	//MIDL_INTERFACE("83CF873A-F6DA-4bc8-823F-BACFD55DC433")
	struct __QOR_INTERFACE(__WINQL_MEDIA) IMFTopology : public IMFAttributes
	{
	public:

		static const GUID _IID;

		virtual unsigned long __QCMP_STDCALLCONVENTION GetTopologyID(Cmp_unsigned__int64* pID) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION AddNode(IMFTopologyNode* pNode) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION RemoveNode(IMFTopologyNode* pNode) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION GetNodeCount(unsigned short* pwNodes) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION GetNode(unsigned short wIndex, IMFTopologyNode** ppNode) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION Clear(void) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION CloneFrom(IMFTopology* pTopology) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION GetNodeByID(Cmp_unsigned__int64 qwTopoNodeID, IMFTopologyNode** ppNode) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION GetSourceNodeCollection(IMFCollection** ppCollection) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION GetOutputNodeCollection(IMFCollection** ppCollection) = 0;

	};

	//--------------------------------------------------------------------------------
	//MIDL_INTERFACE("DF598932-F10C-4E39-BBA2-C308F101DAA3")
	struct __QOR_INTERFACE(__WINQL_MEDIA) IMFMediaEvent : public IMFAttributes
	{
	public:

		static const GUID _IID;

		virtual unsigned long __QCMP_STDCALLCONVENTION GetType(unsigned long* pmet) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION GetExtendedType(GUID* pguidExtendedType) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION GetStatus(unsigned long* phrStatus) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION GetValue(PROPVARIANT* pvValue) = 0;

	};

	//--------------------------------------------------------------------------------
	//MIDL_INTERFACE("ac6b7889-0740-4d51-8619-905994a55cc6")
	struct __QOR_INTERFACE(__WINQL_MEDIA) IMFAsyncResult : public IUnknown
	{
	public:

		static const GUID _IID;

		virtual unsigned long __QCMP_STDCALLCONVENTION GetState(IUnknown** ppunkState) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION GetStatus(void) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION SetStatus(unsigned long hrStatus) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION GetObject(IUnknown** ppObject) = 0;
		virtual IUnknown* __QCMP_STDCALLCONVENTION GetStateNoAddRef(void) = 0;
	};

	//--------------------------------------------------------------------------------
	//MIDL_INTERFACE("a27003cf-2354-4f2a-8d6a-ab7cff15437e")
	struct __QOR_INTERFACE(__WINQL_MEDIA) __declspec(uuid("a27003cf-2354-4f2a-8d6a-ab7cff15437e")) IMFAsyncCallback : public IUnknown
	{
	public:

		static const GUID _IID;
		virtual unsigned long __QCMP_STDCALLCONVENTION GetParameters(unsigned long* pdwFlags, unsigned long* pdwQueue) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION Invoke(IMFAsyncResult* pAsyncResult) = 0;

	};

	//--------------------------------------------------------------------------------
	//MIDL_INTERFACE("2CD0BD52-BCD5-4B89-B62C-EADC0C031E7D")
	struct __QOR_INTERFACE(__WINQL_MEDIA) IMFMediaEventGenerator : public IUnknown
	{
	public:

		static const GUID _IID;

		virtual unsigned long __QCMP_STDCALLCONVENTION GetEvent(unsigned long dwFlags, IMFMediaEvent** ppEvent) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION BeginGetEvent(IMFAsyncCallback* pCallback, IUnknown* punkState) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION EndGetEvent(IMFAsyncResult* pResult, IMFMediaEvent** ppEvent) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION QueueEvent(unsigned long met, const GUID& guidExtendedType, unsigned long hrStatus, const PROPVARIANT* pvValue) = 0;
	};

	//--------------------------------------------------------------------------------
	//MIDL_INTERFACE("2eb1e945-18b8-4139-9b1a-d5d584818530")
	struct __QOR_INTERFACE(__WINQL_MEDIA) IMFClock : public IUnknown
	{
	public:

		static const GUID _IID;

		virtual unsigned long __QCMP_STDCALLCONVENTION GetClockCharacteristics(unsigned long* pdwCharacteristics) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION GetCorrelatedTime(unsigned long dwReserved, Cmp_long_long* pllClockTime, Cmp_long_long* phnsSystemTime) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION GetContinuityKey(unsigned long* pdwContinuityKey) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION GetState(unsigned long dwReserved, MFCLOCK_STATE* peClockState) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION GetProperties(MFCLOCK_PROPERTIES* pClockProperties) = 0;
	};

	//--------------------------------------------------------------------------------
	//MIDL_INTERFACE("90377834-21D0-4dee-8214-BA2E3E6C1127")
	struct __QOR_INTERFACE(__WINQL_MEDIA) IMFMediaSession : public IMFMediaEventGenerator
	{
	public:

		static const GUID _IID;

		virtual unsigned long __QCMP_STDCALLCONVENTION SetTopology(unsigned long dwSetTopologyFlags, IMFTopology* pTopology) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION ClearTopologies(void) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION Start(const GUID* pguidTimeFormat, const PROPVARIANT* pvarStartPosition) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION Pause(void) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION Stop(void) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION Close(void) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION Shutdown(void) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION GetClock(IMFClock** ppClock) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION GetSessionCapabilities(unsigned long* pdwCaps) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION GetFullTopology(unsigned long dwGetFullTopologyFlags, Cmp_unsigned__int64 TopoId, IMFTopology** ppFullTopology) = 0;
	};

	//__QCMP_LINKAGE_C const GUID __QCMP_DECLARE_MERGE_INITIALIZERS MF_DEVSOURCE_ATTRIBUTE_SOURCE_TYPE = { 0xc60ac5fe, 0x252a, 0x478f, { 0xa0, 0xef, 0xbc, 0x8f, 0xa5, 0xf7, 0xca,0xd3 } };
	//__QCMP_LINKAGE_C const GUID __QCMP_DECLARE_MERGE_INITIALIZERS MF_DEVSOURCE_ATTRIBUTE_SOURCE_TYPE_VIDCAP_GUID = { 0x8ac3587a, 0x4ae7, 0x42d8, { 0x99, 0xe0, 0x0a, 0x60, 0x13, 0xee, 0xf9, 0x0f } };

	//--------------------------------------------------------------------------------
	//MIDL_INTERFACE("ad4c100b-422f-9175-4bf7-0d6693d91375")
	struct __QOR_INTERFACE(__WINQL_MEDIA) __declspec( uuid( "ad4c100b-422f-9175-4bf7-0d6693d91375" ) ) IMFPeriodicCallback : public IUnknown
	{
	public:

		static const GUID _IID;

		virtual unsigned long __QCMP_STDCALLCONVENTION Callback(void) = 0;
	};

	extern "C" const GUID __declspec( selectany ) IMFPeriodicCallback_IID = { 0xad4c100b, 0x422f, 0x9175, 0x4b, 0xf7, 0x0d, 0x66, 0x93, 0xd9, 0x13, 0x75 };

	//--------------------------------------------------------------------------------
	//MIDL_INTERFACE("ad4c1b00-4bf7-422f-9175-756693d9130d")
	struct __QOR_INTERFACE(__WINQL_MEDIA) IMFByteStream : public IUnknown
	{
	public:

		static const GUID _IID;

		virtual unsigned long __QCMP_STDCALLCONVENTION GetCapabilities(unsigned long* pdwCapabilities) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION GetLength(Cmp_unsigned_long_long* pqwLength) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION SetLength(Cmp_unsigned_long_long qwLength) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION GetCurrentPosition(Cmp_unsigned_long_long* pqwPosition) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION SetCurrentPosition(Cmp_unsigned_long_long qwPosition) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION IsEndOfStream(int* pfEndOfStream) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION Read(unsigned char* pb, unsigned long cb, unsigned long* pcbRead) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION BeginRead(unsigned char* pb, unsigned long cb, IMFAsyncCallback* pCallback, IUnknown* punkState) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION EndRead(IMFAsyncResult* pResult, unsigned long* pcbRead) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION Write(const unsigned char* pb, unsigned long cb, unsigned long* pcbWritten) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION BeginWrite(const unsigned char* pb, unsigned long cb, IMFAsyncCallback* pCallback, IUnknown* punkState) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION EndWrite(IMFAsyncResult* pResult, unsigned long* pcbWritten) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION Seek(MFBYTESTREAM_SEEK_ORIGIN SeekOrigin, Cmp_long_long llSeekOffset, unsigned long dwSeekFlags, Cmp_unsigned_long_long* pqwCurrentPosition) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION Flush(void) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION Close(void) = 0;
	};

	//--------------------------------------------------------------------------------
	//MIDL_INTERFACE("F6696E82-74F7-4f3d-A178-8A5E09C3659F")
	struct __QOR_INTERFACE(__WINQL_MEDIA) IMFClockStateSink : public IUnknown
	{
	public:

		static const GUID _IID;

		virtual unsigned long __QCMP_STDCALLCONVENTION OnClockStart(Cmp_long_long hnsSystemTime, Cmp_long_long llClockStartOffset) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION OnClockStop(Cmp_long_long hnsSystemTime) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION OnClockPause(Cmp_long_long hnsSystemTime) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION OnClockRestart(Cmp_long_long hnsSystemTime) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION OnClockSetRate(Cmp_long_long hnsSystemTime, float flRate) = 0;
	};

	//--------------------------------------------------------------------------------
	//MIDL_INTERFACE("7FF12CCE-F76F-41c2-863B-1666C8E5E139")
	struct __QOR_INTERFACE(__WINQL_MEDIA) IMFPresentationTimeSource : public IMFClock
	{
	public:

		static const GUID _IID;

		virtual unsigned long __QCMP_STDCALLCONVENTION GetUnderlyingClock(IMFClock** ppClock) = 0;
	};

	//--------------------------------------------------------------------------------
	//MIDL_INTERFACE("868CE85C-8EA9-4f55-AB82-B009A910A805")
	struct __QOR_INTERFACE(__WINQL_MEDIA) IMFPresentationClock : public IMFClock
	{
	public:

		static const GUID _IID;

		virtual unsigned long __QCMP_STDCALLCONVENTION SetTimeSource(IMFPresentationTimeSource* pTimeSource) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION GetTimeSource(IMFPresentationTimeSource** ppTimeSource) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION GetTime(Cmp_long_long* phnsClockTime) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION AddClockStateSink(IMFClockStateSink* pStateSink) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION RemoveClockStateSink(IMFClockStateSink* pStateSink) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION Start(Cmp_long_long llClockStartOffset) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION Stop(void) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION Pause(void) = 0;

	};

	//--------------------------------------------------------------------------------
	//MIDL_INTERFACE("045FA593-8799-42b8-BC8D-8968C6453507")
	struct __QOR_INTERFACE(__WINQL_MEDIA) IMFMediaBuffer : public IUnknown
	{
	public:

		static const GUID _IID;

		virtual unsigned long __QCMP_STDCALLCONVENTION Lock(unsigned char** ppbBuffer, unsigned long* pcbMaxLength, unsigned long* pcbCurrentLength) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION Unlock(void) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION GetCurrentLength(unsigned long* pcbCurrentLength) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION SetCurrentLength(unsigned long cbCurrentLength) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION GetMaxLength(unsigned long* pcbMaxLength) = 0;

	};

	//--------------------------------------------------------------------------------
	//MIDL_INTERFACE("c40a00f2-b93a-4d80-ae8c-5a1c634f58e4")
	struct __QOR_INTERFACE(__WINQL_MEDIA) IMFSample : public IMFAttributes
	{
	public:

		static const GUID _IID;

		virtual unsigned long __QCMP_STDCALLCONVENTION GetSampleFlags(unsigned long* pdwSampleFlags) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION SetSampleFlags(unsigned long dwSampleFlags) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION GetSampleTime(Cmp_long_long* phnsSampleTime) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION SetSampleTime(Cmp_long_long hnsSampleTime) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION GetSampleDuration(Cmp_long_long* phnsSampleDuration) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION SetSampleDuration(Cmp_long_long hnsSampleDuration) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION GetBufferCount(unsigned long* pdwBufferCount) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION GetBufferByIndex(unsigned long dwIndex, IMFMediaBuffer** ppBuffer) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION ConvertToContiguousBuffer(IMFMediaBuffer** ppBuffer) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION AddBuffer(IMFMediaBuffer* pBuffer) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION RemoveBufferByIndex(unsigned long dwIndex) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION RemoveAllBuffers(void) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION GetTotalLength(unsigned long* pcbTotalLength) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION CopyToBuffer(IMFMediaBuffer *pBuffer) = 0;

	};

	//--------------------------------------------------------------------------------
	//MIDL_INTERFACE("e93dcf6c-4b07-4e1e-8123-aa16ed6eadf5")
	struct __QOR_INTERFACE(__WINQL_MEDIA) IMFMediaTypeHandler : public IUnknown
	{
	public:

		static const GUID _IID;

		virtual unsigned long __QCMP_STDCALLCONVENTION IsMediaTypeSupported(IMFMediaType* pMediaType, IMFMediaType** ppMediaType) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION GetMediaTypeCount(unsigned long* pdwTypeCount) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION GetMediaTypeByIndex(unsigned long dwIndex, IMFMediaType** ppType) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION SetCurrentMediaType(IMFMediaType* pMediaType) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION GetCurrentMediaType(IMFMediaType** ppMediaType) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION GetMajorType(GUID* pguidMajorType) = 0;

	};

	//forward declaration
	struct __QOR_INTERFACE(__WINQL_MEDIA) IMFMediaSink;

	//--------------------------------------------------------------------------------
	//MIDL_INTERFACE("0A97B3CF-8E7C-4a3d-8F8C-0C843DC247FB")
	struct __QOR_INTERFACE(__WINQL_MEDIA) IMFStreamSink : public IMFMediaEventGenerator
	{
	public:

		static const GUID _IID;

		virtual unsigned long __QCMP_STDCALLCONVENTION GetMediaSink(IMFMediaSink** ppMediaSink) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION GetIdentifier(unsigned long* pdwIdentifier) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION GetMediaTypeHandler(IMFMediaTypeHandler** ppHandler) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION ProcessSample(IMFSample *pSample) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION PlaceMarker(MFSTREAMSINK_MARKER_TYPE eMarkerType, const PROPVARIANT *pvarMarkerValue, const PROPVARIANT* pvarContextValue) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION Flush(void) = 0;

	};

	//--------------------------------------------------------------------------------
	//MIDL_INTERFACE("6ef2a660-47c0-4666-b13d-cbb717f2fa2c")
	struct __QOR_INTERFACE(__WINQL_MEDIA) IMFMediaSink : public IUnknown
	{
	public:

		static const GUID _IID;

		virtual unsigned long __QCMP_STDCALLCONVENTION GetCharacteristics(unsigned long* pdwCharacteristics) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION AddStreamSink(unsigned long dwStreamSinkIdentifier, IMFMediaType* pMediaType, IMFStreamSink** ppStreamSink) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION RemoveStreamSink(unsigned long dwStreamSinkIdentifier) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION GetStreamSinkCount(unsigned long* pcStreamSinkCount) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION GetStreamSinkByIndex(unsigned long dwIndex, IMFStreamSink** ppStreamSink) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION GetStreamSinkById(unsigned long dwStreamSinkIdentifier, IMFStreamSink** ppStreamSink) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION SetPresentationClock(IMFPresentationClock* pPresentationClock) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION GetPresentationClock(IMFPresentationClock** ppPresentationClock) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION Shutdown(void) = 0;

	};

	//--------------------------------------------------------------------------------
	//MIDL_INTERFACE("56c03d9c-9dbb-45f5-ab4b-d80f47c05938")
	struct __QOR_INTERFACE(__WINQL_MEDIA) IMFStreamDescriptor : public IMFAttributes
	{
	public:

		static const GUID _IID;

		virtual unsigned long __QCMP_STDCALLCONVENTION GetStreamIdentifier(unsigned long* pdwStreamIdentifier) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION GetMediaTypeHandler(IMFMediaTypeHandler** ppMediaTypeHandler) = 0;
	};

	//--------------------------------------------------------------------------------
	//MIDL_INTERFACE("03cb2711-24d7-4db6-a17f-f3a7a479a536")
	struct __QOR_INTERFACE(__WINQL_MEDIA) IMFPresentationDescriptor : public IMFAttributes
	{
	public:

		static const GUID _IID;

		virtual unsigned long __QCMP_STDCALLCONVENTION GetStreamDescriptorCount(unsigned long* pdwDescriptorCount) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION GetStreamDescriptorByIndex(unsigned long dwIndex, int* pfSelected, IMFStreamDescriptor** ppDescriptor) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION SelectStream(unsigned long dwDescriptorIndex) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION DeselectStream(unsigned long dwDescriptorIndex) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION Clone(IMFPresentationDescriptor** ppPresentationDescriptor) = 0;

	};

	//--------------------------------------------------------------------------------
	//MIDL_INTERFACE("279a808d-aec7-40c8-9c6b-a6b492c78a66")
	struct __QOR_INTERFACE(__WINQL_MEDIA) IMFMediaSource : public IMFMediaEventGenerator
	{
	public:

		static const GUID _IID;

		virtual unsigned long __QCMP_STDCALLCONVENTION GetCharacteristics(unsigned long* pdwCharacteristics) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION CreatePresentationDescriptor(IMFPresentationDescriptor** ppPresentationDescriptor) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION Start(IMFPresentationDescriptor* pPresentationDescriptor, const GUID* pguidTimeFormat, const PROPVARIANT* pvarStartPosition) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION Stop(void) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION Pause(void) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION Shutdown(void) = 0;
	};

	//--------------------------------------------------------------------------------
	//MIDL_INTERFACE("886d8eeb-8cf2-4446-8d02-cdba1dbdcf99")
	struct __QOR_INTERFACE(__WINQL_MEDIA) IPropertyStore : public IUnknown
	{
	public:

		static const GUID _IID;

		virtual unsigned long __QCMP_STDCALLCONVENTION GetCount(unsigned long* cProps) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION GetAt(unsigned long iProp, PROPERTYKEY* pkey) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION GetValue(const PROPERTYKEY& key, PROPVARIANT* pv) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION SetValue(const PROPERTYKEY& key, const PROPVARIANT& propvar) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION Commit(void) = 0;

	};

	//--------------------------------------------------------------------------------
	//MIDL_INTERFACE("699bdc27-bbaf-49ff-8e38-9c39c9b5e088")
	struct __QOR_INTERFACE(__WINQL_MEDIA) IMFASFStreamPrioritization : public IUnknown
	{
	public:

		static const GUID _IID;

		virtual unsigned long __QCMP_STDCALLCONVENTION GetStreamCount(unsigned long* pdwStreamCount) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION GetStream(unsigned long dwStreamIndex, unsigned short* pwStreamNumber, unsigned short* pwStreamFlags) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION AddStream(unsigned short wStreamNumber, unsigned short wStreamFlags) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION RemoveStream(unsigned long dwStreamIndex) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION Clone(IMFASFStreamPrioritization** ppIStreamPrioritization) = 0;

	};

	//--------------------------------------------------------------------------------
	//MIDL_INTERFACE("12558291-E399-11D5-BC2A-00B0D0F3F4AB")
	struct __QOR_INTERFACE(__WINQL_MEDIA) IMFASFMutualExclusion : public IUnknown
	{
	public:

		static const GUID _IID;

		virtual unsigned long __QCMP_STDCALLCONVENTION GetType(GUID* pguidType) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION SetType(const GUID& guidType) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION GetRecordCount(unsigned long* pdwRecordCount) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION GetStreamsForRecord(unsigned long dwRecordNumber, unsigned short* pwStreamNumArray, unsigned long* pcStreams) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION AddStreamForRecord(unsigned long dwRecordNumber, unsigned short wStreamNumber) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION RemoveStreamFromRecord(unsigned long dwRecordNumber, unsigned short wStreamNumber) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION RemoveRecord(unsigned long dwRecordNumber) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION AddRecord(unsigned long* pdwRecordNumber) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION Clone(IMFASFMutualExclusion** ppIMutex) = 0;
	};

	//--------------------------------------------------------------------------------
	//MIDL_INTERFACE("9E8AE8D2-DBBD-4200-9ACA-06E6DF484913")
	struct __QOR_INTERFACE(__WINQL_MEDIA) IMFASFStreamConfig : public IMFAttributes
	{
	public:

		static const GUID _IID;

		virtual unsigned long __QCMP_STDCALLCONVENTION GetStreamType(GUID* pguidStreamType) = 0;
		virtual unsigned short __QCMP_STDCALLCONVENTION GetStreamNumber(void) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION SetStreamNumber(unsigned short wStreamNum) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION GetMediaType(IMFMediaType** ppIMediaType) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION SetMediaType(IMFMediaType* pIMediaType) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION GetPayloadExtensionCount(unsigned short* pcPayloadExtensions) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION GetPayloadExtension(unsigned short wPayloadExtensionNumber, GUID* pguidExtensionSystemID, unsigned short* pcbExtensionDataSize, unsigned char* pbExtensionSystemInfo, unsigned long* pcbExtensionSystemInfo) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION AddPayloadExtension(GUID guidExtensionSystemID, unsigned short cbExtensionDataSize, unsigned char* pbExtensionSystemInfo, unsigned long cbExtensionSystemInfo) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION RemoveAllPayloadExtensions(void) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION Clone(IMFASFStreamConfig** ppIStreamConfig) = 0;

	};

	//--------------------------------------------------------------------------------
	//MIDL_INTERFACE("D267BF6A-028B-4e0d-903D-43F0EF82D0D4")
	struct __QOR_INTERFACE(__WINQL_MEDIA) IMFASFProfile : public IMFAttributes
	{
	public:

		static const GUID _IID;

		virtual unsigned long __QCMP_STDCALLCONVENTION GetStreamCount(unsigned long* pcStreams) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION GetStream(unsigned long dwStreamIndex, unsigned short* pwStreamNumber, IMFASFStreamConfig** ppIStream) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION GetStreamByNumber(unsigned short wStreamNumber, IMFASFStreamConfig** ppIStream) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION SetStream(IMFASFStreamConfig* pIStream) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION RemoveStream(unsigned short wStreamNumber) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION CreateStream(IMFMediaType* pIMediaType, IMFASFStreamConfig** ppIStream) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION GetMutualExclusionCount(unsigned long* pcMutexs) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION GetMutualExclusion(unsigned long dwMutexIndex, IMFASFMutualExclusion** ppIMutex) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION AddMutualExclusion(IMFASFMutualExclusion* pIMutex) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION RemoveMutualExclusion(unsigned long dwMutexIndex) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION CreateMutualExclusion(IMFASFMutualExclusion** ppIMutex) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION GetStreamPrioritization(IMFASFStreamPrioritization** ppIStreamPrioritization) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION AddStreamPrioritization(IMFASFStreamPrioritization* pIStreamPrioritization) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION RemoveStreamPrioritization(void) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION CreateStreamPrioritization(IMFASFStreamPrioritization** ppIStreamPrioritization) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION Clone(IMFASFProfile** ppIProfile) = 0;
	};

	//--------------------------------------------------------------------------------
	//MIDL_INTERFACE("B1DCA5CD-D5DA-4451-8E9E-DB5C59914EAD")
	struct __QOR_INTERFACE(__WINQL_MEDIA) IMFASFContentInfo : public IUnknown
	{
	public:

		static const GUID _IID;

		virtual unsigned long __QCMP_STDCALLCONVENTION GetHeaderSize(IMFMediaBuffer* pIStartOfContent, Cmp_unsigned_long_long* cbHeaderSize) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION ParseHeader(IMFMediaBuffer* pIHeaderBuffer, Cmp_unsigned_long_long cbOffsetWithinHeader) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION GenerateHeader(IMFMediaBuffer* pIHeader, unsigned long* pcbHeader) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION GetProfile(IMFASFProfile** ppIProfile) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION SetProfile(IMFASFProfile* pIProfile) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION GeneratePresentationDescriptor(IMFPresentationDescriptor** ppIPresentationDescriptor) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION GetEncodingConfigurationPropertyStore(unsigned short wStreamNumber, IPropertyStore** ppIStore) = 0;

	};

	//--------------------------------------------------------------------------------
	//MIDL_INTERFACE("53590F48-DC3B-4297-813F-787761AD7B3E")
	struct __QOR_INTERFACE(__WINQL_MEDIA) IMFASFIndexer : public IUnknown
	{
	public:

		static const GUID _IID;

		virtual unsigned long __QCMP_STDCALLCONVENTION SetFlags(unsigned long dwFlags) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION GetFlags(unsigned long* pdwFlags) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION Initialize(IMFASFContentInfo* pIContentInfo) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION GetIndexPosition(IMFASFContentInfo* pIContentInfo, unsigned long long* pcbIndexOffset) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION SetIndexByteStreams(IMFByteStream** ppIByteStreams, unsigned long cByteStreams) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION GetIndexByteStreamCount(unsigned long* pcByteStreams) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION GetIndexStatus(ASF_INDEX_IDENTIFIER* pIndexIdentifier, int* pfIsIndexed, unsigned char* pbIndexDescriptor, unsigned long* pcbIndexDescriptor) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION SetIndexStatus(unsigned char* pbIndexDescriptor, unsigned long cbIndexDescriptor, int fGenerateIndex) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION GetSeekPositionForValue(const PROPVARIANT* pvarValue, ASF_INDEX_IDENTIFIER* pIndexIdentifier, unsigned long long* pcbOffsetWithinData, long long* phnsApproxTime, unsigned long* pdwPayloadNumberOfStreamWithinPacket) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION GenerateIndexEntries(IMFSample* pIASFPacketSample) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION CommitIndex(IMFASFContentInfo* pIContentInfo) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION GetIndexWriteSpace(unsigned long long* pcbIndexWriteSpace) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION GetCompletedIndex(IMFMediaBuffer* pIIndexBuffer, unsigned long long cbOffsetWithinIndex) = 0;

	};

	//--------------------------------------------------------------------------------
	//MIDL_INTERFACE("57BDD80A-9B38-4838-B737-C58F670D7D4F")
	struct __QOR_INTERFACE(__WINQL_MEDIA) IMFASFMultiplexer : public IUnknown
	{
	public:

		static const GUID _IID;

		virtual unsigned long __QCMP_STDCALLCONVENTION Initialize(IMFASFContentInfo* pIContentInfo) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION SetFlags(unsigned long dwFlags) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION GetFlags(unsigned long* pdwFlags) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION ProcessSample(unsigned short wStreamNumber, IMFSample* pISample, Cmp_long_long hnsTimestampAdjust) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION GetNextPacket(unsigned long* pdwStatusFlags, IMFSample** ppIPacket) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION Flush(void) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION End(IMFASFContentInfo* pIContentInfo) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION GetStatistics(unsigned short wStreamNumber, ASF_MUX_STATISTICS* pMuxStats) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION SetSyncTolerance(unsigned long msSyncTolerance) = 0;
	};

	//--------------------------------------------------------------------------------
	//MIDL_INTERFACE("12558295-E399-11D5-BC2A-00B0D0F3F4AB")
	struct __QOR_INTERFACE(__WINQL_MEDIA) IMFASFSplitter : public IUnknown
	{
	public:

		static const GUID _IID;

		virtual unsigned long __QCMP_STDCALLCONVENTION Initialize(IMFASFContentInfo* pIContentInfo) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION SetFlags(unsigned long dwFlags) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION GetFlags(unsigned long* pdwFlags) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION SelectStreams(unsigned short* pwStreamNumbers, unsigned short wNumStreams) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION GetSelectedStreams(unsigned short* pwStreamNumbers, unsigned short* pwNumStreams) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION ParseData(IMFMediaBuffer* pIBuffer, unsigned long cbBufferOffset, unsigned long cbLength) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION GetNextSample(unsigned long* pdwStatusFlags, unsigned short* pwStreamNumber, IMFSample** ppISample) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION Flush(void) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION GetLastSendTime(unsigned long* pdwLastSendTime) = 0;
	};

	//--------------------------------------------------------------------------------
	//MIDL_INTERFACE("7FEE9E9A-4A89-47a6-899C-B6A53A70FB67")
	struct __QOR_INTERFACE(__WINQL_MEDIA) IMFActivate : public IMFAttributes
	{
	public:

		static const GUID _IID;

		virtual unsigned long __QCMP_STDCALLCONVENTION ActivateObject(const GUID& riid, void** ppv) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION ShutdownObject(void) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION DetachObject(void) = 0;
	};

	//--------------------------------------------------------------------------------
	//MIDL_INTERFACE("6D4C7B74-52A0-4bb7-B0DB-55F29F47A668")
	struct __QOR_INTERFACE(__WINQL_MEDIA) IMFSchemeHandler : public IUnknown
	{
	public:

		static const GUID _IID;

		virtual unsigned long __QCMP_STDCALLCONVENTION BeginCreateObject(const wchar_t* pwszURL, unsigned long dwFlags, IPropertyStore* pProps, IUnknown** ppIUnknownCancelCookie, IMFAsyncCallback* pCallback, IUnknown* punkState) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION EndCreateObject(IMFAsyncResult* pResult, MF_OBJECT_TYPE* pObjectType, IUnknown** ppObject) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION CancelObjectCreation(IUnknown* pIUnknownCancelCookie) = 0;

	};

	//--------------------------------------------------------------------------------
	//MIDL_INTERFACE("e9cd0383-a268-4bb4-82de-658d53574d41")
	struct __QOR_INTERFACE(__WINQL_MEDIA) IMFNetProxyLocator : public IUnknown
	{
	public:

		static const GUID _IID;

		virtual unsigned long __QCMP_STDCALLCONVENTION FindFirstProxy(const wchar_t* pszHost, const wchar_t* pszUrl, int fReserved) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION FindNextProxy(void) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION RegisterProxyResult(unsigned long hrOp) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION GetCurrentProxy(wchar_t* pszStr, unsigned long* pcchStr) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION Clone(IMFNetProxyLocator** ppProxyLocator) = 0;

	};

	//--------------------------------------------------------------------------------
	//MIDL_INTERFACE("1cde6309-cae0-4940-907e-c1ec9c3d1d4a")
	/*
	struct __QOR_INTERFACE( __WINQL ) MFRemoteDesktopPlugin : public IUnknown
	{
	public:

	static const GUID _IID;// const GUID GetII( void ){ return _IID; }

	virtual unsigned long __QCMP_STDCALLCONVENTION UpdateTopology( IMFTopology* pTopology ) = 0;
	};*/

	//--------------------------------------------------------------------------------
	//MIDL_INTERFACE("bf94c121-5b05-4e6f-8000-ba598961414d")
	struct __QOR_INTERFACE(__WINQL_MEDIA) IMFTransform : public IUnknown
	{
	public:

		static const GUID _IID;

		virtual unsigned long __QCMP_STDCALLCONVENTION GetStreamLimits(unsigned long* pdwInputMinimum, unsigned long* pdwInputMaximum, unsigned long* pdwOutputMinimum, unsigned long* pdwOutputMaximum) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION GetStreamCount(unsigned long* pcInputStreams, unsigned long* pcOutputStreams) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION GetStreamIDs(unsigned long dwInputIDArraySize, unsigned long* pdwInputIDs, unsigned long dwOutputIDArraySize, unsigned long* pdwOutputIDs) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION GetInputStreamInfo(unsigned long dwInputStreamID, MFT_INPUT_STREAM_INFO* pStreamInfo) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION GetOutputStreamInfo(unsigned long dwOutputStreamID, MFT_OUTPUT_STREAM_INFO* pStreamInfo) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION GetAttributes(IMFAttributes** pAttributes) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION GetInputStreamAttributes(unsigned long dwInputStreamID, IMFAttributes** pAttributes) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION GetOutputStreamAttributes(unsigned long dwOutputStreamID, IMFAttributes** pAttributes) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION DeleteInputStream(unsigned long  dwStreamID) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION AddInputStreams(unsigned long cStreams, unsigned long* adwStreamIDs) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION GetInputAvailableType(unsigned long dwInputStreamID, unsigned long dwTypeIndex, IMFMediaType** ppType) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION GetOutputAvailableType(unsigned long dwOutputStreamID, unsigned long dwTypeIndex, IMFMediaType** ppType) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION SetInputType(unsigned long dwInputStreamID, IMFMediaType* pType, unsigned long dwFlags) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION SetOutputType(unsigned long dwOutputStreamID, IMFMediaType* pType, unsigned long dwFlags) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION GetInputCurrentType(unsigned long dwInputStreamID, IMFMediaType** ppType) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION GetOutputCurrentType(unsigned long dwOutputStreamID, IMFMediaType** ppType) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION GetInputStatus(unsigned long dwInputStreamID, unsigned long* pdwFlags) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION GetOutputStatus(unsigned long* pdwFlags) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION SetOutputBounds(Cmp_long_long hnsLowerBound, Cmp_long_long hnsUpperBound) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION ProcessEvent(unsigned long dwInputStreamID, IMFMediaEvent* pEvent) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION ProcessMessage(MFT_MESSAGE_TYPE eMessage, Cmp_ulong_ptr ulParam) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION ProcessInput(unsigned long dwInputStreamID, IMFSample* pSample, unsigned long dwFlags) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION ProcessOutput(unsigned long dwFlags, unsigned long cOutputBufferCount, MFT_OUTPUT_DATA_BUFFER* pOutputSamples, unsigned long* pdwStatus) = 0;
	};

	//--------------------------------------------------------------------------------
	//MIDL_INTERFACE("197CD219-19CB-4de1-A64C-ACF2EDCBE59E")
	struct __QOR_INTERFACE(__WINQL_MEDIA) IMFSequencerSource : public IUnknown
	{
	public:

		static const GUID _IID;

		virtual unsigned long __QCMP_STDCALLCONVENTION AppendTopology(IMFTopology* pTopology, unsigned long dwFlags, unsigned long* pdwId) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION DeleteTopology(unsigned long dwId) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION GetPresentationContext(IMFPresentationDescriptor* pPD, unsigned long* pId, IMFTopology** ppTopology) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION UpdateTopology(unsigned long dwId, IMFTopology* pTopology) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION UpdateTopologyFlags(unsigned long dwId, unsigned long dwFlags) = 0;
	};

	//--------------------------------------------------------------------------------
	//MIDL_INTERFACE("70ae66f2-c809-4e4f-8915-bdcb406b7993")
	struct __QOR_INTERFACE(__WINQL_MEDIA) IMFSourceReader : public IUnknown
	{
	public:

		static const GUID _IID;

		virtual unsigned long __QCMP_STDCALLCONVENTION GetStreamSelection(unsigned long dwStreamIndex, int* pfSelected) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION SetStreamSelection(unsigned long dwStreamIndex, int fSelected) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION GetNativeMediaType(unsigned long dwStreamIndex, unsigned long dwMediaTypeIndex, IMFMediaType** ppMediaType) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION GetCurrentMediaType(unsigned long dwStreamIndex, IMFMediaType** ppMediaType) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION SetCurrentMediaType(unsigned long dwStreamIndex, unsigned long* pdwReserved, IMFMediaType* pMediaType) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION SetCurrentPosition(const GUID& guidTimeFormat, const PROPVARIANT& varPosition) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION ReadSample(unsigned long dwStreamIndex, unsigned long dwControlFlags, unsigned long* pdwActualStreamIndex, unsigned long* pdwStreamFlags, Cmp_long_long* pllTimestamp, IMFSample** ppSample) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION Flush(unsigned long dwStreamIndex) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION GetServiceForStream(unsigned long dwStreamIndex, const GUID& guidService, const GUID& riid, void** ppvObject) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION GetPresentationAttribute(unsigned long dwStreamIndex, const GUID& guidAttribute, PROPVARIANT* pvarAttribute) = 0;
	};

	//--------------------------------------------------------------------------------
	//MIDL_INTERFACE("DE9A6157-F660-4643-B56A-DF9F7998C7CD")
	struct __QOR_INTERFACE(__WINQL_MEDIA) IMFTopoLoader : public IUnknown
	{
	public:

		static const GUID _IID;

		virtual unsigned long __QCMP_STDCALLCONVENTION Load(IMFTopology* pInputTopo, IMFTopology** ppOutputTopo, IMFTopology* pCurrentTopo) = 0;
	};

	//--------------------------------------------------------------------------------
	//MIDL_INTERFACE("4ADFDBA3-7AB0-4953-A62B-461E7FF3DA1E")
	struct __QOR_INTERFACE(__WINQL_MEDIA) IMFTranscodeProfile : public IUnknown
	{
	public:

		static const GUID _IID;

		virtual unsigned long __QCMP_STDCALLCONVENTION SetAudioAttributes(IMFAttributes* pAttrs) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION GetAudioAttributes(IMFAttributes** ppAttrs) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION SetVideoAttributes(IMFAttributes* pAttrs) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION GetVideoAttributes(IMFAttributes** ppAttrs) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION SetContainerAttributes(IMFAttributes* pAttrs) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION GetContainerAttributes(IMFAttributes** ppAttrs) = 0;
	};

	//--------------------------------------------------------------------------------
	//MIDL_INTERFACE("b99f381f-a8f9-47a2-a5af-ca3a225a3890")
	struct __QOR_INTERFACE(__WINQL_MEDIA) IMFVideoMediaType : public IMFMediaType
	{
	public:

		static const GUID _IID;

		virtual const MFVIDEOFORMAT* __QCMP_STDCALLCONVENTION GetVideoFormat(void) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION GetVideoRepresentation(GUID guidRepresentation, void** ppvRepresentation, long lStride) = 0;

	};

	//------------------------------------------------------------------------------
	//MIDL_INTERFACE("29AFF080-182A-4a5d-AF3B-448F3A6346CB")
	struct __QOR_INTERFACE(__WINQL_MEDIA) IMFVideoPresenter : public IMFClockStateSink
	{
	public:

		static const GUID _IID;

		virtual unsigned long __QCMP_STDCALLCONVENTION ProcessMessage(MFVP_MESSAGE_TYPE eMessage, Cmp_ulong_ptr ulParam) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION GetCurrentMediaType(IMFVideoMediaType** ppMediaType) = 0;

	};

	//------------------------------------------------------------------------------
	//MIDL_INTERFACE("86cbc910-e533-4751-8e3b-f19b5b806a03")
	struct __QOR_INTERFACE(__WINQL_MEDIA) IMFVideoSampleAllocator : public IUnknown
	{
	public:

		static const GUID _IID;

		virtual unsigned long __QCMP_STDCALLCONVENTION SetDirectXManager(IUnknown* pManager) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION UninitializeSampleAllocator(void) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION InitializeSampleAllocator(unsigned long cRequestedFrames, IMFMediaType* pMediaType) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION AllocateSample(IMFSample** ppSample) = 0;

	};

	//------------------------------------------------------------------------------
	//MIDL_INTERFACE("A792CDBE-C374-4e89-8335-278E7B9956A4")
	struct __QOR_INTERFACE(__WINQL_MEDIA) IMFVideoSampleAllocatorNotify : public IUnknown
	{
	public:

		static const GUID _IID;
		virtual unsigned long __QCMP_STDCALLCONVENTION NotifyRelease(void) = 0;
	};

	//------------------------------------------------------------------------------
	//MIDL_INTERFACE("992388B4-3372-4f67-8B6F-C84C071F4751")
	struct __QOR_INTERFACE(__WINQL_MEDIA) IMFVideoSampleAllocatorCallback : public IUnknown
	{
	public:

		static const GUID _IID;

		virtual unsigned long __QCMP_STDCALLCONVENTION SetCallback(IMFVideoSampleAllocatorNotify* pNotify) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION GetFreeSampleCount(long* plSamples) = 0;
	};

	//------------------------------------------------------------------------------
	//MIDL_INTERFACE("5c6c44bf-1db6-435b-9249-e8cd10fdec96")
	struct __QOR_INTERFACE(__WINQL_MEDIA) IMFPluginControl : public IUnknown
	{
	public:

		static const GUID _IID;

		virtual unsigned long __QCMP_STDCALLCONVENTION GetPreferredClsid(unsigned long pluginType, const wchar_t* selector, GUID* clsid) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION GetPreferredClsidByIndex(unsigned long pluginType, unsigned long index, wchar_t* selector, GUID* clsid) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION SetPreferredClsid(unsigned long pluginType, const wchar_t* selector, const GUID* clsid) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION IsDisabled(unsigned long pluginType, const GUID& clsid) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION GetDisabledByIndex(unsigned long pluginType, unsigned long index, GUID* clsid) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION SetDisabled(unsigned long pluginType, const GUID& clsid, int disabled) = 0;
	};

	//------------------------------------------------------------------------------
	//MIDL_INTERFACE("90EB3E6B-ECBF-45cc-B1DA-C6FE3EA70D57")
	struct __QOR_INTERFACE(__WINQL_MEDIA) IMFPMediaItem : public IUnknown
	{
	public:

		static const GUID _IID;

		virtual unsigned long __QCMP_STDCALLCONVENTION GetMediaPlayer(IMFPMediaPlayer** ppMediaPlayer) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION GetURL(wchar_t** ppwszURL) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION GetObject(IUnknown** ppIUnknown) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION GetUserData(Cmp_ulong_ptr* pdwUserData) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION SetUserData(Cmp_ulong_ptr dwUserData) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION GetStartStopPosition(GUID* pguidStartPositionType, PROPVARIANT* pvStartValue, GUID* pguidStopPositionType, PROPVARIANT* pvStopValue) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION SetStartStopPosition(const GUID* pguidStartPositionType, const PROPVARIANT* pvStartValue, const GUID* pguidStopPositionType, const PROPVARIANT* pvStopValue) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION HasVideo(int* pfHasVideo, int* pfSelected) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION HasAudio(int* pfHasAudio, int* pfSelected) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION IsProtected(int* pfProtected) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION GetDuration(const GUID& guidPositionType, PROPVARIANT* pvDurationValue) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION GetNumberOfStreams(unsigned long* pdwStreamCount) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION GetStreamSelection(unsigned long dwStreamIndex, int* pfEnabled) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION SetStreamSelection(unsigned long dwStreamIndex, int fEnabled) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION GetStreamAttribute(unsigned long dwStreamIndex, const GUID& guidMFAttribute, PROPVARIANT* pvValue) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION GetPresentationAttribute(const GUID& guidMFAttribute, PROPVARIANT* pvValue) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION GetCharacteristics(Cmp_unsigned__int32* pCharacteristics) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION SetStreamSink(unsigned long dwStreamIndex, IUnknown* pMediaSink) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION GetMetadata(IPropertyStore** ppMetadataStore) = 0;
	};

	//------------------------------------------------------------------------------
	//MIDL_INTERFACE("A714590A-58AF-430a-85BF-44F5EC838D85")
	struct __QOR_INTERFACE(__WINQL_MEDIA) IMFPMediaPlayer : public IUnknown
	{
	public:

		static const GUID _IID;

		virtual unsigned long __QCMP_STDCALLCONVENTION Play(void) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION Pause(void) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION Stop(void) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION FrameStep(void) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION SetPosition(const GUID& guidPositionType, const PROPVARIANT* pvPositionValue) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION GetPosition(const GUID& guidPositionType, PROPVARIANT* pvPositionValue) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION GetDuration(const GUID& guidPositionType, PROPVARIANT* pvDurationValue) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION SetRate(float flRate) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION GetRate(float* pflRate) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION GetSupportedRates(int fForwardDirection, float* pflSlowestRate, float* pflFastestRate) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION GetState(MFP_MEDIAPLAYER_STATE* peState) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION CreateMediaItemFromURL(const wchar_t* pwszURL, int fSync, Cmp_ulong_ptr dwUserData, IMFPMediaItem** ppMediaItem) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION CreateMediaItemFromObject(IUnknown* pIUnknownObj, int fSync, Cmp_ulong_ptr dwUserData, IMFPMediaItem** ppMediaItem) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION SetMediaItem(IMFPMediaItem* pIMFPMediaItem) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION ClearMediaItem(void) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION GetMediaItem(IMFPMediaItem** ppIMFPMediaItem) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION GetVolume(float* pflVolume) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION SetVolume(float flVolume) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION GetBalance(float* pflBalance) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION SetBalance(float flBalance) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION GetMute(int* pfMute) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION SetMute(int fMute) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION GetNativeVideoSize(SIZE* pszVideo, SIZE* pszARVideo) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION GetIdealVideoSize(SIZE* pszMin, SIZE* pszMax) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION SetVideoSourceRect(const MFVideoNormalizedRect* pnrcSource) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION GetVideoSourceRect(MFVideoNormalizedRect* pnrcSource) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION SetAspectRatioMode(unsigned long dwAspectRatioMode) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION GetAspectRatioMode(unsigned long* pdwAspectRatioMode) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION GetVideoWindow(COSWindow* phwndVideo) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION UpdateVideo(void) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION SetBorderColor(unsigned long Clr) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION GetBorderColor(unsigned long* pClr) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION InsertEffect(IUnknown* pEffect, int fOptional) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION RemoveEffect(IUnknown* pEffect) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION RemoveAllEffects(void) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION Shutdown(void) = 0;

	};

	//------------------------------------------------------------------------------
	//MIDL_INTERFACE("766C8FFB-5FDB-4fea-A28D-B912996F51BD")
	struct __QOR_INTERFACE(__WINQL_MEDIA) IMFPMediaPlayerCallback : public IUnknown
	{
	public:

		static const GUID _IID;

		virtual void __QCMP_STDCALLCONVENTION OnMediaPlayerEvent(MFP_EVENT_HEADER* pEventHeader) = 0;
	};

	//--------------------------------------------------------------------------------
	//MIDL_INTERFACE("5b87ef6a-7ed8-434f-ba0e-184fac1628d1")
	struct __QOR_INTERFACE(__WINQL_MEDIA) IMFNetCredential : public IUnknown
	{
	public:

		static const GUID _IID;

		virtual unsigned long __QCMP_STDCALLCONVENTION SetUser(unsigned char* pbData, unsigned long cbData, int fDataIsEncrypted) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION SetPassword(unsigned char* pbData, unsigned long cbData, int fDataIsEncrypted) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION GetUser(unsigned char* pbData, unsigned long* pcbData, int fEncryptData) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION GetPassword(unsigned char* pbData, unsigned long* pcbData, int fEncryptData) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION LoggedOnUser(int* pfLoggedOnUser) = 0;
	};

	//--------------------------------------------------------------------------------
	//MIDL_INTERFACE("36f846fc-2256-48b6-b58e-e2b638316581")
	struct __QOR_INTERFACE(__WINQL_MEDIA) IMFMediaEventQueue : public IUnknown
	{
	public:

		static const GUID _IID;

		virtual unsigned long __QCMP_STDCALLCONVENTION GetEvent(unsigned long dwFlags, IMFMediaEvent** ppEvent) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION BeginGetEvent(IMFAsyncCallback* pCallback, IUnknown* punkState) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION EndGetEvent(IMFAsyncResult* pResult, IMFMediaEvent** ppEvent) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION QueueEvent(IMFMediaEvent* pEvent) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION QueueEventParamVar(unsigned long met, const GUID& guidExtendedType, unsigned long hrStatus, const PROPVARIANT* pvValue) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION QueueEventParamUnk(unsigned long met, const GUID& guidExtendedType, unsigned long hrStatus, IUnknown* pUnk) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION Shutdown(void) = 0;
	};

	//--------------------------------------------------------------------------------
	//MIDL_INTERFACE("5b87ef6c-7ed8-434f-ba0e-184fac1628d1")
	struct __QOR_INTERFACE(__WINQL_MEDIA) IMFNetCredentialCache : public IUnknown
	{
	public:

		static const GUID _IID;

		virtual unsigned long __QCMP_STDCALLCONVENTION GetCredential(const wchar_t* pszUrl, const wchar_t* pszRealm, unsigned long dwAuthenticationFlags, IMFNetCredential** ppCred, unsigned long* pdwRequirementsFlags) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION SetGood(IMFNetCredential* pCred, int fGood) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION SetUserOptions(IMFNetCredential* pCred, unsigned long dwOptionsFlags) = 0;

	};

	//--------------------------------------------------------------------------------
	//MIDL_INTERFACE("994e23af-1cc2-493c-b9fa-46f1cb040fa4")
	struct __QOR_INTERFACE(__WINQL_MEDIA) IMFPMPServer : public IUnknown
	{
	public:

		static const GUID _IID;

		virtual unsigned long __QCMP_STDCALLCONVENTION LockProcess(void) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION UnlockProcess(void) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION CreateObjectByCLSID(const GUID& clsid, const GUID& riid, void** ppObject) = 0;

	};

	//--------------------------------------------------------------------------------
	//MIDL_INTERFACE("8D009D86-5B9F-4115-B1FC-9F80D52AB8AB")
	struct __QOR_INTERFACE(__WINQL_MEDIA) IMFQualityManager : public IUnknown
	{

	public:

		static const GUID _IID;

		virtual unsigned long __QCMP_STDCALLCONVENTION NotifyTopology(IMFTopology* pTopology) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION NotifyPresentationClock(IMFPresentationClock* pClock) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION NotifyProcessInput(IMFTopologyNode* pNode, long lInputIndex, IMFSample* pSample) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION NotifyProcessOutput(IMFTopologyNode* pNode, long lOutputIndex, IMFSample* pSample) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION NotifyQualityEvent(IUnknown* pObject, IMFMediaEvent* pEvent) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION Shutdown(void) = 0;
	};

	//--------------------------------------------------------------------------------
	//MIDL_INTERFACE("1cde6309-cae0-4940-907e-c1ec9c3d1d4a")
	struct __QOR_INTERFACE(__WINQL_MEDIA) IMFRemoteDesktopPlugin : public IUnknown
	{
	public:

		static const GUID _IID;

		virtual unsigned long __QCMP_STDCALLCONVENTION UpdateTopology(IMFTopology* pTopology) = 0;
	};

	//--------------------------------------------------------------------------------
	//MIDL_INTERFACE("3137f1cd-fe5e-4805-a5d8-fb477448cb3d")
	struct __QOR_INTERFACE(__WINQL_MEDIA) IMFSinkWriter : public IUnknown
	{
	public:

		static const GUID _IID;

		virtual unsigned long __QCMP_STDCALLCONVENTION AddStream(IMFMediaType* pTargetMediaType, unsigned long* pdwStreamIndex) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION SetInputMediaType(unsigned long dwStreamIndex, IMFMediaType* pInputMediaType, IMFAttributes* pEncodingParameters) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION BeginWriting(void) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION WriteSample(unsigned long dwStreamIndex, IMFSample* pSample) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION SendStreamTick(unsigned long dwStreamIndex, long long llTimestamp) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION PlaceMarker(unsigned long dwStreamIndex, void* pvContext) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION NotifyEndOfSegment(unsigned long dwStreamIndex) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION Flush(unsigned long dwStreamIndex) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION Finalize(void) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION GetServiceForStream(unsigned long dwStreamIndex, const GUID& guidService, const GUID& riid, void** ppvObject) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION GetStatistics(unsigned long dwStreamIndex, MF_SINK_WRITER_STATISTICS* pStats) = 0;

	};

	//--------------------------------------------------------------------------------
	//MIDL_INTERFACE("FBE5A32D-A497-4b61-BB85-97B1A848A6E3")
	struct __QOR_INTERFACE(__WINQL_MEDIA) IMFSourceResolver : public IUnknown
	{
	public:

		static const GUID _IID;

		virtual unsigned long __QCMP_STDCALLCONVENTION CreateObjectFromURL(const wchar_t* pwszURL, unsigned long dwFlags, IPropertyStore* pProps, MF_OBJECT_TYPE* pObjectType, IUnknown** ppObject) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION CreateObjectFromByteStream(IMFByteStream* pByteStream, const wchar_t* pwszURL, unsigned long dwFlags, IPropertyStore* pProps, MF_OBJECT_TYPE* pObjectType, IUnknown** ppObject) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION BeginCreateObjectFromURL(const wchar_t* pwszURL, unsigned long dwFlags, IPropertyStore* pProps, IUnknown** ppIUnknownCancelCookie, IMFAsyncCallback* pCallback, IUnknown* punkState) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION EndCreateObjectFromURL(IMFAsyncResult* pResult, MF_OBJECT_TYPE* pObjectType, IUnknown** ppObject) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION BeginCreateObjectFromByteStream(IMFByteStream* pByteStream, const wchar_t* pwszURL, unsigned long dwFlags, IPropertyStore* pProps, IUnknown** ppIUnknownCancelCookie, IMFAsyncCallback* pCallback, IUnknown* punkState) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION EndCreateObjectFromByteStream(IMFAsyncResult* pResult, MF_OBJECT_TYPE* pObjectType, IUnknown** ppObject) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION CancelObjectCreation(IUnknown* pIUnknownCancelCookie) = 0;

	};

	//--------------------------------------------------------------------------------
	//MIDL_INTERFACE("8C7B80BF-EE42-4b59-B1DF-55668E1BDCA8")
	struct __QOR_INTERFACE(__WINQL_MEDIA) IMFSampleGrabberSinkCallback : public IMFClockStateSink
	{
	public:

		static const GUID _IID;

		virtual unsigned long __QCMP_STDCALLCONVENTION OnSetPresentationClock(IMFPresentationClock* pPresentationClock) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION OnProcessSample(const GUID& guidMajorMediaType, unsigned long dwSampleFlags, long long llSampleTime, long long llSampleDuration, const unsigned char* pSampleBuffer, unsigned long dwSampleSize) = 0;
		virtual unsigned long __QCMP_STDCALLCONVENTION OnShutdown(void) = 0;

	};

	//--------------------------------------------------------------------------------
	//MIDL_INTERFACE("D666063F-1587-4E43-81F1-B948E807363F")
	struct __QOR_INTERFACE(__WINQL_MEDIA) IMMDevice : public IUnknown
	{
	public:

		static const GUID _IID;

		virtual long __QCMP_STDCALLCONVENTION Activate(const GUID& iid, unsigned long dwClsCtx, PROPVARIANT* pActivationParams, void** ppInterface) = 0;
		virtual long __QCMP_STDCALLCONVENTION OpenPropertyStore(unsigned long stgmAccess, IPropertyStore** ppProperties) = 0;
		virtual long __QCMP_STDCALLCONVENTION GetId(wchar_t** ppstrId) = 0;
		virtual long __QCMP_STDCALLCONVENTION GetState(unsigned long* pdwState) = 0;
	};

	//--------------------------------------------------------------------------------
	//MIDL_INTERFACE("0BD7A1BE-7A1A-44DB-8397-CC5392387B5E")
	struct __QOR_INTERFACE(__WINQL_MEDIA) IMMDeviceCollection : public IUnknown
	{
	public:

		static const GUID _IID;

		virtual long __QCMP_STDCALLCONVENTION GetCount(unsigned int* pcDevices) = 0;
		virtual long __QCMP_STDCALLCONVENTION Item(unsigned int nDevice, IMMDevice** ppDevice) = 0;
	};

	//--------------------------------------------------------------------------------
	//MIDL_INTERFACE("7991EEC9-7E89-4D85-8390-6C703CEC60C0")
	struct __QOR_INTERFACE(__WINQL_MEDIA) IMMNotificationClient : public IUnknown
	{
	public:

		static const GUID _IID;

		virtual long __QCMP_STDCALLCONVENTION OnDeviceStateChanged(const wchar_t* pwstrDeviceId, unsigned long dwNewState) = 0;
		virtual long __QCMP_STDCALLCONVENTION OnDeviceAdded(const wchar_t* pwstrDeviceId) = 0;
		virtual long __QCMP_STDCALLCONVENTION OnDeviceRemoved(const wchar_t* pwstrDeviceId) = 0;
		virtual long __QCMP_STDCALLCONVENTION OnDefaultDeviceChanged(EDataFlow flow, ERole role, const wchar_t* pwstrDefaultDeviceId) = 0;
		virtual long __QCMP_STDCALLCONVENTION OnPropertyValueChanged(const wchar_t* pwstrDeviceId, const PROPERTYKEY key) = 0;
	};

	//--------------------------------------------------------------------------------
	//MIDL_INTERFACE("A95664D2-9614-4F35-A746-DE8DB63617E6")
	struct __QOR_INTERFACE(__WINQL_MEDIA) IMMDeviceEnumerator : public IUnknown
	{
	public:

		static const GUID _IID;

		virtual long __QCMP_STDCALLCONVENTION EnumAudioEndpoints(EDataFlow dataFlow, unsigned long dwStateMask, IMMDeviceCollection** ppDevices) = 0;
		virtual long __QCMP_STDCALLCONVENTION GetDefaultAudioEndpoint(EDataFlow dataFlow, ERole role, IMMDevice** ppEndpoint) = 0;
		virtual long __QCMP_STDCALLCONVENTION GetDevice(const wchar_t* pwstrId, IMMDevice** ppDevice) = 0;
		virtual long __QCMP_STDCALLCONVENTION RegisterEndpointNotificationCallback(IMMNotificationClient* pClient) = 0;
		virtual long __QCMP_STDCALLCONVENTION UnregisterEndpointNotificationCallback(IMMNotificationClient* pClient) = 0;

	};

	//--------------------------------------------------------------------------------
	//MIDL_INTERFACE("24918ACC-64B3-37C1-8CA9-74A66E9957A8")
	struct __QOR_INTERFACE(__WINQL_MEDIA) IAudioSessionEvents : public IUnknown
	{
	public:

		static const GUID _IID;

		virtual long __QCMP_STDCALLCONVENTION OnDisplayNameChanged(const wchar_t* NewDisplayName, const GUID* EventContext) = 0;
		virtual long __QCMP_STDCALLCONVENTION OnIconPathChanged(const wchar_t* NewIconPath, const GUID* EventContext) = 0;
		virtual long __QCMP_STDCALLCONVENTION OnSimpleVolumeChanged(float NewVolume, int NewMute, const GUID* EventContext) = 0;
		virtual long __QCMP_STDCALLCONVENTION OnChannelVolumeChanged(unsigned long ChannelCount, float NewChannelVolumeArray[], unsigned long ChangedChannel, const GUID* EventContext) = 0;
		virtual long __QCMP_STDCALLCONVENTION OnGroupingParamChanged(const GUID* NewGroupingParam, const GUID* EventContext) = 0;
		virtual long __QCMP_STDCALLCONVENTION OnStateChanged(AudioSessionState NewState) = 0;
		virtual long __QCMP_STDCALLCONVENTION OnSessionDisconnected(AudioSessionDisconnectReason DisconnectReason) = 0;
	};

	//--------------------------------------------------------------------------------
	//MIDL_INTERFACE("F4B1A599-7266-4319-A8CA-E70ACB11E8CD")
	struct __QOR_INTERFACE(__WINQL_MEDIA) IAudioSessionControl : public IUnknown
	{
	public:

		static const GUID _IID;

		virtual long __QCMP_STDCALLCONVENTION GetState(AudioSessionState* pRetVal) = 0;
		virtual long __QCMP_STDCALLCONVENTION GetDisplayName(wchar_t**pRetVal) = 0;
		virtual long __QCMP_STDCALLCONVENTION SetDisplayName(const wchar_t* Value, const GUID* EventContext) = 0;
		virtual long __QCMP_STDCALLCONVENTION GetIconPath(wchar_t** pRetVal) = 0;
		virtual long __QCMP_STDCALLCONVENTION SetIconPath(const wchar_t* Value, const GUID* EventContext) = 0;
		virtual long __QCMP_STDCALLCONVENTION GetGroupingParam(GUID* pRetVal) = 0;
		virtual long __QCMP_STDCALLCONVENTION SetGroupingParam(const GUID* Override, const GUID* EventContext) = 0;
		virtual long __QCMP_STDCALLCONVENTION RegisterAudioSessionNotification(IAudioSessionEvents* NewNotifications) = 0;
		virtual long __QCMP_STDCALLCONVENTION UnregisterAudioSessionNotification(IAudioSessionEvents* NewNotifications) = 0;
	};

	//--------------------------------------------------------------------------------
	//MIDL_INTERFACE("87CE5498-68D6-44E5-9215-6DA47EF883D8")
	struct __QOR_INTERFACE(__WINQL_MEDIA) ISimpleAudioVolume : public IUnknown
	{
	public:

		static const GUID _IID;

		virtual long __QCMP_STDCALLCONVENTION SetMasterVolume(float fLevel, const GUID* EventContext) = 0;
		virtual long __QCMP_STDCALLCONVENTION GetMasterVolume(float* pfLevel) = 0;
		virtual long __QCMP_STDCALLCONVENTION SetMute(const int bMute, const GUID* EventContext) = 0;
		virtual long __QCMP_STDCALLCONVENTION GetMute(int* pbMute) = 0;

	};

	//--------------------------------------------------------------------------------
	//MIDL_INTERFACE("BFA971F1-4D5E-40BB-935E-967039BFBEE4")
	struct __QOR_INTERFACE(__WINQL_MEDIA) IAudioSessionManager : public IUnknown
	{

	public:

		static const GUID _IID;

		virtual long __QCMP_STDCALLCONVENTION GetAudioSessionControl(const GUID* AudioSessionGuid, unsigned long StreamFlags, IAudioSessionControl** SessionControl) = 0;
		virtual long __QCMP_STDCALLCONVENTION GetSimpleAudioVolume(const GUID* AudioSessionGuid, unsigned long StreamFlags, ISimpleAudioVolume** AudioVolume) = 0;
	};

}//nsWin32

#endif//WINQL_MEDIAINTERFACES_H_3
